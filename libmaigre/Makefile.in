LIBMAIGRE_SOURCES =  \
	maigre-mono-bridge.c \
	maigre-rc-style.c \
	maigre-style.c \
	maigre-theme-module.c

LIBMAIGRE_OTHER =  \
	maigre-mono-bridge.h \
	maigre-rc-style.h \
	maigre-style.h

CC = gcc
LIBMAIGRE_CFLAGS = -Wall -O2 -ggdb3 @PKG_CFLAGS@ $(CFLAGS)
LIBMAIGRE_LDFLAGS = -shared @PKG_LIBS@ $(LDFLAGS)
LIBMAIGRE_OBJECTS = $(LIBMAIGRE_SOURCES:.c=.o)

all: libmaigre.so

libmaigre.so: codegen $(LIBMAIGRE_OBJECTS)
	$(CC) $(LIBMAIGRE_LDFLAGS) $(LIBMAIGRE_OBJECTS) -o $@

codegen: ../maigre-codegen/maigre-codegen.py
	./$<
	touch maigre-style.c

.c.o:
	$(CC) -c $(LIBMAIGRE_CFLAGS) $< -o $@

clean:
	rm -rf $(LIBMAIGRE_OBJECTS) libmaigre.so maigre-style-overrides.c
